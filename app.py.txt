import streamlit as st
from transformers import pipeline

@st.cache_resource
def load_model():
    return pipeline("text-classification", 
                    model="namakamu/sarkasmeter-indonesia-v1",  # â† GANTI namakamu
                    return_all_scores=True)

classifier = load_model()

st.title("ğŸ‡®ğŸ‡© Sarkasmeter Indonesia")
st.markdown("### Deteksi sarkasme, humor, atau netral dalam 1 detik!")

teks = st.text_area("Masukkan kalimat:", placeholder="Contoh: pastipemiliknya mau naik haji tiga kali sehari", height=120)

if st.button("ğŸ” Cek Sarkasme!", type="primary"):
    if teks.strip():
        with st.spinner("Sedang mikir..."):
            hasil = classifier(teks)[0]
        st.success("Selesai!")
        
        # Urutkan dari skor tertinggi
        sorted_hasil = sorted(hasil, key=lambda x: x['score'], reverse=True)
        
        for item in sorted_hasil:
            label = {"LABEL_0": "ğŸ˜ Netral", "LABEL_1": "ğŸ˜‚ Lucu/Humor", "LABEL_2": "ğŸ˜ Sarkasme/Nyindir"}[item['label']]
            skor = item['score'] * 100
            st.markdown(f"**{label}** â†’ **{skor:.1f}%**")
            st.progress(skor/100)
    else:
        st.warning("Tulis kalimat dulu dong!")